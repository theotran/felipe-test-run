!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):e.ReactInputMask=t(e.React)}(this,function(e){"use strict";function t(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}e="default"in e?e["default"]:e;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){function t(e){n(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));l.call(r),r.hasValue=null!=e.value,r.charsRules=null!=e.formatChars?e.formatChars:r.defaultCharsRules;var s=r.parseMask(e.mask),o=null!=e.defaultValue?e.defaultValue:"",i=null!=e.value?e.value:o;return i=r.getStringValue(i),r.mask=s.mask,r.permanents=s.permanents,r.lastEditablePos=s.lastEditablePos,r.maskChar="maskChar"in e?e.maskChar:r.defaultMaskChar,r.mask&&(e.alwaysShowMask||i)&&(i=r.formatValue(i)),r.state={value:i},r}return r(t,e),t}(e.Component),l=function(){var n=this;this.defaultCharsRules={9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},this.defaultMaskChar="_",this.lastCursorPos=null,this.isAndroidBrowser=function(){var e=new RegExp("windows","i"),t=new RegExp("firefox","i"),n=new RegExp("android","i"),a=navigator.userAgent;return!e.test(a)&&!t.test(a)&&n.test(a)},this.isWindowsPhoneBrowser=function(){var e=new RegExp("windows","i"),t=new RegExp("phone","i"),n=navigator.userAgent;return e.test(n)&&t.test(n)},this.isAndroidFirefox=function(){var e=new RegExp("windows","i"),t=new RegExp("firefox","i"),n=new RegExp("android","i"),a=navigator.userAgent;return!e.test(a)&&t.test(a)&&n.test(a)},this.isDOMElement=function(e){return"object"===("undefined"==typeof HTMLElement?"undefined":o(HTMLElement))?e instanceof HTMLElement:1===e.nodeType&&"string"==typeof e.nodeName},this.getInputDOMNode=function(){var t=n.input;return t?n.isDOMElement(t)?t:e.findDOMNode(t):null},this.enableValueAccessors=function(){if(n.canUseAccessors){var e=n.getInputDOMNode();n.valueDescriptor=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),"value"),Object.defineProperty(e,"value",{configurable:!0,enumerable:!0,get:function(){return n.value},set:function(t){n.value=t,n.valueDescriptor.set.call(e,t)}})}},this.disableValueAccessors=function(){var e=n.valueDescriptor;if(e){n.valueDescriptor=null;var t=n.getInputDOMNode();Object.defineProperty(t,"value",e)}},this.getInputValue=function(){var e=n.getInputDOMNode(),t=n.valueDescriptor;return t?t.get.call(e):e.value},this.setInputValue=function(e){var t=n.getInputDOMNode();n.value=e,t.value=e},this.getPrefix=function(){for(var e="",t=n.mask,a=0;a<t.length&&n.isPermanentChar(a);++a)e+=t[a];return e},this.getFilledLength=function(){var e,t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:n.state.value;if(!n.maskChar)return t.length;for(e=t.length-1;e>=0;--e){var a=t[e];if(!n.isPermanentChar(e)&&n.isAllowedChar(a,e))break}return++e||n.getPrefix().length},this.getLeftEditablePos=function(e){for(var t=e;t>=0;--t)if(!n.isPermanentChar(t))return t;return null},this.getRightEditablePos=function(e){for(var t=n.mask,a=e;a<t.length;++a)if(!n.isPermanentChar(a))return a;return null},this.isEmpty=function(){return!(arguments.length>0&&arguments[0]!==undefined?arguments[0]:n.state.value).split("").some(function(e,t){return!n.isPermanentChar(t)&&n.isAllowedChar(e,t)})},this.isFilled=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:n.state.value;return n.getFilledLength(e)===n.mask.length},this.createFilledArray=function(e,t){for(var n=[],a=0;a<e;a++)n[a]=t;return n},this.formatValue=function(e){var t=n.maskChar,a=n.mask;if(!t){var r=n.getPrefix(),s=r.length;for(e=n.insertRawSubstr("",e,0);e.length>s&&n.isPermanentChar(e.length-1);)e=e.slice(0,e.length-1);return e.length<s&&(e=r),e}if(e){var o=n.formatValue("");return n.insertRawSubstr(o,e,0)}return e.split("").concat(n.createFilledArray(a.length-e.length,null)).map(function(e,r){return n.isAllowedChar(e,r)?e:n.isPermanentChar(r)?a[r]:t}).join("")},this.clearRange=function(e,t,a){var r=t+a,s=n.maskChar,o=n.mask;if(!s){var i=n.getPrefix().length;return e=e.split("").filter(function(e,n){return n<i||n<t||n>=r}).join(""),n.formatValue(e)}return e.split("").map(function(e,a){return a<t||a>=r?e:n.isPermanentChar(a)?o[a]:s}).join("")},this.replaceSubstr=function(e,t,n){return e.slice(0,n)+t+e.slice(n+t.length)},this.insertRawSubstr=function(e,t,a){var r=n.mask,s=n.maskChar,o=n.isFilled(e),i=n.getPrefix().length;t=t.split(""),!s&&a>e.length&&(e+=r.slice(e.length,a));for(var l=a;l<r.length&&t.length;){var u=n.isPermanentChar(l);if(u&&r[l]!==t[0])!s&&l>=e.length?e+=r[l]:s&&u&&t[0]===s&&t.shift(),++l;else{var c=t.shift();n.isAllowedChar(c,l,!0)&&(l<e.length?e=s||o||l<i?n.replaceSubstr(e,c,l):n.formatValue(e.substr(0,l)+c+e.substr(l)):s||(e+=c),++l)}}return e},this.getRawSubstrLength=function(e,t,a){var r=n.mask,s=a;for(t=t.split("");s<r.length&&t.length;)if(n.isPermanentChar(s)&&r[s]!==t[0])++s;else{var o=t.shift();n.isAllowedChar(o,s,!0)&&++s}return s-a},this.isAllowedChar=function(e,t){var a=arguments.length>2&&arguments[2]!==undefined&&arguments[2],r=n.mask,s=n.maskChar;if(n.isPermanentChar(t))return r[t]===e;var o=r[t],i=n.charsRules[o];return new RegExp(i).test(e||"")||a&&e===s},this.isPermanentChar=function(e){return-1!==n.permanents.indexOf(e)},this.setCursorToEnd=function(){var e=n.getFilledLength(),t=n.getRightEditablePos(e);null!==t&&n.setCursorPos(t)},this.setSelection=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,a=n.getInputDOMNode();if(a){var r=e+t;if("selectionStart"in a&&"selectionEnd"in a)a.selectionStart=e,a.selectionEnd=r;else{var s=a.createTextRange();s.collapse(!0),s.moveStart("character",e),s.moveEnd("character",r-e),s.select()}}},this.getSelection=function(){var e=n.getInputDOMNode(),t=0,a=0;if("selectionStart"in e&&"selectionEnd"in e)t=e.selectionStart,a=e.selectionEnd;else{var r=document.selection.createRange();r.parentElement()===e&&(t=-r.moveStart("character",-e.value.length),a=-r.moveEnd("character",-e.value.length))}return{start:t,end:a,length:a-t}},this.getCursorPos=function(){return n.getSelection().start},this.setCursorPos=function(e){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){return setTimeout(e,0)},a=n.setSelection.bind(n,e,0);a(),t(a),n.lastCursorPos=e},this.isFocused=function(){return document.activeElement===n.getInputDOMNode()},this.parseMask=function(e){if(!e||"string"!=typeof e)return{mask:null,lastEditablePos:null,permanents:[]};var t="",a=[],r=!1,s=null;return e.split("").forEach(function(e){r||"\\"!==e?(r||!n.charsRules[e]?a.push(t.length):s=t.length+1,t+=e,r=!1):r=!0}),{mask:t,lastEditablePos:s,permanents:a}},this.getStringValue=function(e){return e||0===e?e+"":""},this.componentWillMount=function(){var e=n.mask,t=n.state.value;e&&t&&n.setState({value:t})},this.componentWillReceiveProps=function(e){n.hasValue=null!=e.value,n.charsRules=null!=e.formatChars?e.formatChars:n.defaultCharsRules;var t=n.mask,a=n.parseMask(e.mask),r=a.mask&&a.mask!==n.mask;if(n.mask=a.mask,n.permanents=a.permanents,n.lastEditablePos=a.lastEditablePos,n.maskChar="maskChar"in e?e.maskChar:n.defaultMaskChar,n.mask){var s=null!=e.value?n.getStringValue(e.value):n.state.value;t||null!=e.value||(s=n.getInputDOMNode().value);var o=e.alwaysShowMask||n.isFocused();if((r||a.mask&&(s||o))&&(s=n.formatValue(s),r)){var i=n.lastCursorPos,l=n.getFilledLength(s);(null===i||l<i)&&(i=n.isFilled(s)?l:n.getRightEditablePos(l),n.setCursorPos(i))}!a.mask||!n.isEmpty(s)||o||n.hasValue&&e.value||(s=""),n.value=s,n.state.value!==s&&n.setState({value:s})}else n.lastCursorPos=null},this.componentDidUpdate=function(e){(n.mask||e.mask)&&null==n.props.value&&n.updateUncontrolledInput(),n.valueDescriptor&&n.getInputValue()!==n.state.value&&n.setInputValue(n.state.value)},this.updateUncontrolledInput=function(){n.getInputValue()!==n.state.value&&n.setInputValue(n.state.value)},this.onKeyDown=function(e){var t="function"==typeof n.props.onKeyDown;if(e.ctrlKey||e.metaKey)t&&n.props.onKeyDown(e);else{var a=n.getCursorPos(),r=n.state.value,s=e.key,o=!1;switch(s){case"Backspace":case"Delete":var i=n.getPrefix().length,l="Delete"===s,u=n.getSelection();if(u.length)r=n.clearRange(r,u.start,u.length);else if(a<i||!l&&a===i)a=i;else{var c=l?n.getRightEditablePos(a):n.getLeftEditablePos(a-1);null!==c&&(r=n.clearRange(r,c,1),a=c)}o=!0}t&&n.props.onKeyDown(e),r!==n.state.value&&(n.setInputValue(r),n.setState({value:n.hasValue?n.state.value:r}),o=!0,"function"==typeof n.props.onChange&&n.props.onChange(e)),o&&(e.preventDefault(),n.setCursorPos(a))}},this.onKeyPress=function(e){var t=e.key,a="function"==typeof n.props.onKeyPress;if("Enter"===t||e.ctrlKey||e.metaKey)a&&n.props.onKeyPress(e);else if(!n.isWindowsPhoneBrowser){var r=n.getCursorPos(),s=n.getSelection(),o=n.state.value,i=n.mask,l=n.lastEditablePos,u=n.getPrefix().length;if(n.isPermanentChar(r)&&i[r]===t)o=n.insertRawSubstr(o,t,r),++r;else{var c=n.getRightEditablePos(r);null!==c&&n.isAllowedChar(t,c)&&(o=n.clearRange(o,s.start,s.length),o=n.insertRawSubstr(o,t,c),r=c+1)}o!==n.state.value&&(n.setInputValue(o),n.setState({value:n.hasValue?n.state.value:o}),"function"==typeof n.props.onChange&&n.props.onChange(e)),e.preventDefault(),r<l&&r>u&&(r=n.getRightEditablePos(r)),n.setCursorPos(r)}},this.onChange=function(e){var t=n.pasteSelection,a=n.mask,r=n.maskChar,s=n.lastEditablePos,o=n.getInputValue();if(!o&&n.preventEmptyChange)return n.disableValueAccessors(),n.preventEmptyChange=!1,void n.setInputValue(n.state.value);var i=n.state.value;if(t)return n.pasteSelection=null,void n.pasteText(i,o,t,e);var l,u=n.getSelection(),c=u.end,f=a.length,p=o.length,h=i.length,g=n.getPrefix().length;if(p>h){var d=p-h,v=u.end-d,m=o.substr(v,d);c=v<s&&(1!==d||m!==a[v])?n.getRightEditablePos(v):v,o=o.substr(0,v)+o.substr(v+d),l=n.clearRange(o,v,f-v),l=n.insertRawSubstr(l,m,c),o=n.insertRawSubstr(i,m,c),1!==d||c>=g&&c<s?c=n.getFilledLength(l):c<s&&c++}else if(p<h){var w=f-p;l=n.clearRange(i,u.end,w);var b=o.substr(0,u.end),C=b===i.substr(0,u.end);r&&(o=n.insertRawSubstr(l,b,0)),l=n.clearRange(l,u.end,f-u.end),l=n.insertRawSubstr(l,b,0),C?c<g&&(c=g):c=n.getFilledLength(l)}o=n.formatValue(o),n.isWindowsPhoneBrowser?(e.persist(),setTimeout(function(){n.setInputValue(o),n.hasValue||n.setState({value:o}),"function"==typeof n.props.onChange&&n.props.onChange(e),n.setCursorPos(c)},0)):(n.canUseAccessors&&n.isAndroidBrowser||n.setInputValue(o),n.canUseAccessors&&(n.isAndroidFirefox&&o&&!n.getInputValue()||n.isAndroidBrowser)&&(n.value=o,n.enableValueAccessors(),n.isAndroidFirefox&&(n.preventEmptyChange=!0),setTimeout(function(){n.preventEmptyChange=!1,n.disableValueAccessors()},0)),n.setState({value:n.hasValue?n.state.value:o}),"function"==typeof n.props.onChange&&n.props.onChange(e),n.setCursorPos(c))},this.onFocus=function(e){if(n.state.value)n.getFilledLength()<n.mask.length&&n.setCursorToEnd();else{var t=n.getPrefix(),a=n.formatValue(t),r=n.formatValue(a),s=r!==e.target.value;s&&(e.target.value=r),n.setState({value:n.hasValue?n.state.value:r},n.setCursorToEnd),s&&"function"==typeof n.props.onChange&&n.props.onChange(e)}"function"==typeof n.props.onFocus&&n.props.onFocus(e)},this.onBlur=function(e){if(!n.props.alwaysShowMask&&n.isEmpty(n.state.value)){var t=""!==n.getInputValue();t&&n.setInputValue(""),n.setState({value:n.hasValue?n.state.value:""}),t&&"function"==typeof n.props.onChange&&n.props.onChange(e)}"function"==typeof n.props.onBlur&&n.props.onBlur(e)},this.onPaste=function(e){if(n.isAndroidBrowser)return n.pasteSelection=n.getSelection(),void n.setInputValue("");var t;if(window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData&&(t=e.clipboardData.getData("text/plain")),t){var a=n.state.value,r=n.getSelection();n.pasteText(a,t,r,e)}e.preventDefault()},this.pasteText=function(e,t,a,r){var s=a.start;a.length&&(e=n.clearRange(e,s,a.length));var o=n.getRawSubstrLength(e,t,s);e=n.insertRawSubstr(e,t,s),s+=o,s=n.getRightEditablePos(s)||s,e!==n.getInputValue()&&(r&&n.setInputValue(e),n.setState({value:n.hasValue?n.state.value:e}),r&&"function"==typeof n.props.onChange&&n.props.onChange(r)),n.setCursorPos(s)},this.componentDidMount=function(){n.isAndroidBrowser=n.isAndroidBrowser(),n.isWindowsPhoneBrowser=n.isWindowsPhoneBrowser(),n.isAndroidFirefox=n.isAndroidFirefox();var e=n.getInputDOMNode();if(e&&Object.getOwnPropertyDescriptor&&Object.getPrototypeOf&&Object.defineProperty){var t=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),"value");n.canUseAccessors=!!(t&&t.get&&t.set)}n.mask&&null==n.props.value&&n.updateUncontrolledInput()},this.render=function(){var a=n.props,r=(a.mask,a.alwaysShowMask,a.maskChar,a.formatChars,t(a,["mask","alwaysShowMask","maskChar","formatChars"]));return n.mask&&(r.disabled||r.readOnly||["onFocus","onBlur","onChange","onKeyDown","onKeyPress","onPaste"].forEach(function(e){r[e]=n[e]}),null!=r.value&&(r.value=n.state.value)),e.createElement("input",s({ref:function(e){return n.input=e}},r))}};return i});
